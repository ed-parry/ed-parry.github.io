{{ define "main" }}
<div class="stream">
    {{ $posts := where .Site.RegularPages "Section" "posts" }}
    {{ range $posts }}
        {{ if .Title }}
            {{ if .Params.link }}
                <!-- External link post: title links to external URL with arrow indicator -->
                <article class="post link-post">
                    <h2><a href="{{ .Params.link }}" target="_blank" rel="noopener">{{ .Title }}<span class="external-arrow">→</span></a></h2>
                    <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}" data-timestamp="{{ .Date.Unix }}"></time>
                    <div class="commentary">
                        {{ .Content }}
                    </div>
                </article>
            {{ else }}
                <!-- Post with title: show title, first paragraph, and read more link -->
                <article class="post titled-post">
                    <h2><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
                    <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}" data-timestamp="{{ .Date.Unix }}"></time>
                    <div class="excerpt">
                        {{ .Summary }}
                    </div>
                    {{ if .Truncated }}
                        <a href="{{ .RelPermalink }}" class="read-more">Read more →</a>
                    {{ end }}
                </article>
            {{ end }}
        {{ else }}
            {{ if .Params.quote }}
                <!-- Quote post: large quote block with optional commentary below -->
                <article class="post quote-post">
                    <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}" data-timestamp="{{ .Date.Unix }}"></time>
                    <blockquote class="quote-block">
                        {{ .Params.quote | markdownify }}
                        {{ if .Params.author }}
                            <cite>— {{ .Params.author }}</cite>
                        {{ end }}
                    </blockquote>
                    {{ if .Content }}
                        <div class="quote-commentary">
                            {{ .Content }}
                        </div>
                    {{ end }}
                </article>
            {{ else }}
                <!-- Post without title: show inline -->
                <article class="post inline-post">
                    <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}" data-timestamp="{{ .Date.Unix }}"></time>
                    <div class="content">
                        {{ .Content }}
                    </div>
                </article>
            {{ end }}
        {{ end }}
    {{ end }}
</div>
{{ end }}
